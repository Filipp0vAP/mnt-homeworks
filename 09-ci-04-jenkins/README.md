# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ –∑–∞–Ω—è—Ç–∏—é "09.04 Jenkins"

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é

1. –°–æ–∑–¥–∞—Ç—å 2 VM: –¥–ª—è jenkins-master –∏ jenkins-agent.
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å jenkins –ø—Ä–∏ –ø–æ–º–æ—â–∏ playbook'a.
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.
4. –°–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É.

## –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å

1. –°–¥–µ–ª–∞—Ç—å Freestyle Job, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å `molecule test` –∏–∑ –ª—é–±–æ–≥–æ –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å —Ä–æ–ª—å—é.
2. –°–¥–µ–ª–∞—Ç—å Declarative Pipeline Job, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å `molecule test` –∏–∑ –ª—é–±–æ–≥–æ –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å —Ä–æ–ª—å—é.
3. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ Declarative Pipeline –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ —Ñ–∞–π–ª `Jenkinsfile`.
4. –°–æ–∑–¥–∞—Ç—å Multibranch Pipeline –Ω–∞ –∑–∞–ø—É—Å–∫ `Jenkinsfile` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
5. –°–æ–∑–¥–∞—Ç—å Scripted Pipeline, –Ω–∞–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ —Å–∫—Ä–∏–ø—Ç–æ–º –∏–∑ [pipeline](./pipeline).
6. –í–Ω–µ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —á—Ç–æ–±—ã Pipeline –∑–∞–ø—É—Å–∫–∞–ª `ansible-playbook` –±–µ–∑ —Ñ–ª–∞–≥–æ–≤ `--check --diff`, –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –¥–∂–æ–±—ã (prod_run = True), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ False –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–≥–æ–Ω —Å —Ñ–ª–∞–≥–∞–º–∏ `--check --diff`.
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π Pipeline –≤–ª–æ–∂–∏—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ —Ñ–∞–π–ª `ScriptedJenkinsfile`.
8. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å —Ä–æ–ª—å—é –∏ Declarative Pipeline –∏ Scripted Pipeline.

## –û—Ç–≤–µ—Ç—ã

0. –°–æ–∑–¥–∞–ª –º–∞—à–∏–Ω—ã –∏ —É—Å—Ç–∞–Ω–æ–≤–∏–ª jenkins –ø—Ä–∏ –ø–æ–º–æ—â–∏ playbook'a.
![Ansible-playbook.png](./img/Ansible-playbook.png)

1. –°–¥–µ–ª–∞–ª Freestyle Job, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç `molecule test` –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è 08-ansible-04-role 
`(–Ω–∞ —ç—Ç–æ–º –º–æ–º–µ–Ω—Ç–µ –±—ã–ª –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–¥–æ–ª–∏–Ω–≥ –∏–∑-–∑–∞ —Ç–æ–≥–æ —á—Ç–æ –º–æ–ª–µ–∫—É–ª–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ —Å Python 3.6, –∞ —á–µ—Ä–µ–∑ yum –Ω–µ–ª—å–∑—è –ø–æ—Å—Ç–∞–≤–∏—Ç—å python 3.10 –∏ –ø—Ä–∏—à–ª–æ—Å—å —Å–æ–±–∏—Ä–∞—Ç—å –µ–≥–æ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤, –∏ –∫–æ–≥–¥–∞ —è —ç—Ç–æ –¥–µ–ª–∞–ª –æ–Ω–∞ –µ–≥–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞. –ù–æ –≤ –∏—Ç–æ–≥–µ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ —è –∑–∞—Å—Ç–∞–≤–∏–ª –≤—Å–µ —Ä–∞–±–æ—Ç–∞—Ç—å üéâü•≥)`
![Freestyle_1](./img/Freestyle_1.png)
![Freestyle_2](./img/Freestyle_2.png)

2. –°–¥–µ–ª–∞–ª Declarative Pipeline Job, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç —Ç–æ–∂–µ —Å–∞–º–æ–µ
![Declarative_Pipeline_from_Jenkins_1](./img/Declarative_Pipeline_from_Jenkins_1.png)
![Declarative_Pipeline_from_Jenkins_2](./img/Declarative_Pipeline_from_Jenkins_2.png)

3. –ü–µ—Ä–µ–Ω–µ—Å –ø–∞–π–ø–ª–∞–π–Ω –≤ –≥–∏—Ç –∏ –ø—Ä–æ–≤–µ—Ä–∏–ª —Ä–∞–±–æ—Ç—É
![Declarative_Pipeline_from_Git](./img/Declarative_Pipeline_from_Git.png)

4. –°–æ–∑–¥–∞–ª Multibranch Pipeline –Ω–∞ –∑–∞–ø—É—Å–∫ `Jenkinsfile` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
![Multibranch_Pipeline](./img/Multibranch_Pipeline.png)

5. –°–æ–∑–¥–∞–ª Scripted Pipeline, –Ω–∞–ø–æ–ª–Ω–∏–ª –µ–≥–æ —Å–∫—Ä–∏–ø—Ç–æ–º –∏–∑ [pipeline](./pipeline). 
–°–¥–µ–ª–∞–ª –≤—ã–±–æ—Ä –∑–Ω–∞—á–µ–Ω–∏—è prod_run, —Å–¥–µ–ª–∞–ª —Ñ–æ—Ä–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –ø—Ä–æ–ø–∏—Å–∞–ª –µ–≥–æ –≤ [—Å–∫—Ä–∏–ø—Ç](./pipeline/Jenkinsfile) –∏ –¥–æ–±–∏–ª—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∂–æ–±—ã —Å —É—Å–ø–µ—à–Ω—ã–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –ø–ª–µ–π–±—É–∫–∞
![Scripted_Pipeline](./img/Scripted_Pipeline.png)
![scripted_playbook_ok](./img/scripted_playbook_ok.png)

## –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å

1. –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞ groovy, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –≤—Å–µ Job, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –Ω–µ—É—Å–ø–µ—à–Ω–æ. –î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å —Ä–µ—à–µ–Ω–∏–µ–º —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º `AllJobFailure.groovy`.
2. –°–æ–∑–¥–∞—Ç—å Scripted Pipeline —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ Ya.Cloud CLI –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤, –ø—Ä–æ–ø–∏—Å–∞—Ç—å –∏—Ö –≤ –∏–Ω–≤–µ–Ω—Ç–æ—Ä–∏ –ø–ª–µ–π–±—É–∫–∞ –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–ª–µ–π–±—É–∫. –¢–µ–º —Å–∞–º—ã–º, –º—ã –¥–æ–ª–∂–Ω—ã –ø–æ –Ω–∞–∂–∞—Ç–∏—é –∫–Ω–æ–ø–∫–∏ –ø–æ–ª—É—á–∏—Ç—å –≥–æ—Ç–æ–≤—É—é –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—É.

---

### –ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –î–ó?

–í—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –ø—Ä–∏—à–ª–∏—Ç–µ —Å—Å—ã–ª–∫–æ–π –Ω–∞ .md-—Ñ–∞–π–ª –≤ –≤–∞—à–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---
